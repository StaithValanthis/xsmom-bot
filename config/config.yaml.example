# =========================
# XSMOM Bot - Full Config
# Profile: small account (~$400), market-neutral, low churn
# =========================

exchange:
  id: bybit
  account_type: swap
  quote: USDT
  only_perps: true
  unified_margin: true
  testnet: false

  # Universe / liquidity gates
  max_symbols: 12
  min_usd_volume_24h: 20000000   # avoid thin alts
  min_price: 0.01

  # Data granularity
  timeframe: "1h"
  candles_limit: 1200

strategy:
  # Momentum model
  lookbacks: [1, 6, 24]
  lookback_weights: [1.0, 1.0, 1.0]
  vol_lookback: 48

  # Breadth (lower for small balance -> lower turnover/slippage)
  k_min: 4
  k_max: 8

  # Portfolio shape
  market_neutral: true
  gross_leverage: 1.35           # strategy-level gross; exchange leverage set below
  max_weight_per_asset: 0.18     # cap single-name exposure

  # Regime gating (loosened to allow entries in flat regimes)
  regime_filter:
    enabled: true
    ema_len: 150
    slope_min_bps_per_day: 0

  # Funding (carry) tilt away from expensive funding
  funding_tilt:
    enabled: true
    weight: 0.15

liquidity:
  # Donâ€™t exceed 0.3% of 24h quote volume and $120 notional per symbol
  adv_cap_pct: 0.003
  notional_cap_usdt: 120

execution:
  # For small accounts, ensure fills (fees are manageable)
  order_type: market
  post_only: false
  price_offset_bps: 0
  slippage_bps_guard: 25

  # Exchange leverage; used per-symbol
  set_leverage: 3

  # Cadence & funding alignment
  rebalance_minute: 15
  poll_seconds: 15
  align_after_funding_minutes: 5
  funding_hours_utc: [0, 8, 16]

risk:
  # Core ATR sizing
  atr_len: 21
  atr_mult_sl: 2.2
  atr_mult_tp: 3.8
  use_tp: true

  # Intrabar fast management
  fast_check_seconds: 2
  stop_timeframe: "3m"
  trailing_enabled: true
  trail_atr_mult: 2.2
  breakeven_after_r: 1.5

  # Wick resistance / noise filters
  stop_on_close_only: true
  stop_buffer_bps: 8
  cooldown_minutes_after_stop: 30

  # Partial take profit (one-shot)
  partial_tp_enabled: true
  partial_tp_r: 2.0
  partial_tp_size: 0.5

  # Kill switch & churn gate
  max_daily_loss_pct: 5.0
  trade_disable_minutes: 120
  min_close_pnl_pct: 1.0

costs:
  taker_fee_bps: 6.0
  maker_fee_bps: 0.0
  slippage_bps: 8.0
  funding_bps_per_day: 1.0

paths:
  state_path: "state/state.json"
  logs_dir: "logs"

logging:
  level: INFO
  file_max_mb: 20
  file_backups: 5